{"version":3,"sources":["models/Pokemon.ts","models/unknown-pokemon.png","models/utilities.ts","hooks/useCachedQuery.ts","components/PokemonImage.tsx","components/PokemonDetails.tsx","components/PokemonNavigation.tsx","App.tsx","index.tsx"],"names":["capitalize","original","toUpperCase","slice","getPokemonName","match","name","suffix","getUnknownPokemon","pokemon","error","UnknownPokemonPNG","sprites","cache","usePokemonQuery","url","useState","result","setResult","query","setError","loading","setLoading","useEffect","canceler","cached","token","axios","CancelToken","c","get","cancelToken","then","response","data","isCancel","useQ","id","nameId","front_default","back_default","types","sort","a","b","Math","sign","slot","map","type","getPokemon","noop","PokemonImage","flipped","setFlipped","front","back","toggleFlipped","useCallback","onClick","className","title","src","alt","PokemonDetails","selected","unselect","PokemonDetailsView","stateClassNames","push","join","PokemonDetailsHeader","children","PokemonMistryImage","loaded","setLoaded","onLoad","onError","hidden","getMisteryPokemonSprite","PokemonEntry","reference","getPokemonIdFromURL","lastIndexOf","length","PokemonNavigation","setSelected","pokemons","setPokemons","useInfiniteQuery","page","pageParam","results","getNextPageParam","last","all","isFetchingNextPage","hasNextPage","fetchNextPage","status","pages","flat","useInfinitePokemonQuery","done","fetch","parentRef","useRef","useVirtual","size","estimateSize","virtualItems","totalSize","canFetchNextPage","isLastPokemonOnScreen","index","ref","style","height","row","isOverflow","isLoadingRow","tabIndex","measureRef","transform","start","App","AppHeader","AppFooter","target","rel","href","client","QueryClient","ReactDOM","render","StrictMode","QueryClientProvider","document","getElementById","location","protocol","host","startsWith","replace"],"mappings":"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","file":"static/js/main.d10e8153.chunk.js","sourcesContent":["import { PokemonResponse } from \"./PokeAPI\";\n\nexport default interface Pokemon {\n  id: string;\n  nameId: string;\n  name: string;\n  sprites: [front: string | null, back: string | null];\n  types: string[];\n}\n\nfunction capitalize(original: string): string {\n  return original[0].toUpperCase() + original.slice(1);\n}\n\nexport function getPokemonName(original: string) {\n  original = capitalize(original);\n\n  // This was overkill\n\n  const match = original.match(/([a-z]+)-([-a-z]+)$/i);\n\n  if (match) {\n    const name = match[1];\n    const suffix = match[2];\n    switch (suffix) {\n      // Replacements\n      case \"f\":\n      case \"female\":\n        return `Female ${name}`;\n      case \"m\":\n      case \"male\":\n        return `Male ${name}`;\n      case \"jr\":\n        return `${name} Junior`;\n      case \"mime\":\n      case \"rime\":\n        // As second word\n        return `${name} ${suffix}`; // Mr mime, Mr rime\n      case \"red-meteor\":\n        return `Red meteor ${name}`;\n      case \"red-striped\":\n        return `Red striped ${name}`;\n      case \"single-strike\":\n        return `Single strike ${name}`;\n      case \"rapid-strike\":\n        return `Rapid strike ${name}`;\n      case \"oh\":\n      case \"o\":\n      case \"fini\":\n      case \"koko\":\n      case \"bulu\":\n      case \"lele\":\n        // As suffix with a hyphen\n        return `${name}-${suffix}`; // Ho-oh\n      case \"amped-gmax\":\n        return `Amped gmax ${name}`;\n      case \"low-key\":\n        return `Low key ${name}`;\n      case \"low-key-gmax\":\n        return `Low key gmax ${name}`;\n      case \"single-strike-gmax\":\n        return `Single strike gmax ${name}`;\n      case \"rapid-strike-gmax\":\n        return `Rapid strike gmax ${name}`;\n      case \"normal\":\n      case \"crowned\":\n      case \"totem\":\n      case \"totem-busted\":\n      case \"original\":\n      case \"amped\":\n      case \"ordinary\":\n      case \"average\":\n      case \"standard\":\n      case \"disguised\":\n      case \"altered\":\n      case \"eternal\":\n      case \"primal\":\n      case \"core\":\n      case \"small\":\n      case \"large\":\n      case \"hero\":\n      case \"galar\":\n      case \"mega\":\n      case \"gmax\":\n      case \"super\":\n      case \"eternamax\":\n        // As prefix adjective\n        return `${capitalize(suffix)} ${name}`;\n      case \"mega-x\":\n        return `Mega X ${name}`;\n      case \"mega-y\":\n        return `Mega Y ${name}`;\n      case \"incarnate\":\n        // As postfix adjective\n        return `${name} ${suffix}`;\n      case \"null\":\n        return \"Type: Null\";\n      default:\n        if (name === \"Porygon\") {\n          return name + \" \" + suffix.toUpperCase();\n        } else if (name === \"Oricorio\") {\n          return `${name} (${capitalize(suffix)} style)`;\n        } else {\n          return `${name} (${capitalize(suffix)} form)`;\n        }\n    }\n  }\n  return original;\n}\n\nexport function getPokemon(response: PokemonResponse): Pokemon {\n  const name = response.name;\n  return {\n    id: response.id,\n    nameId: name,\n    name: getPokemonName(name),\n    sprites: [\n      response.sprites.front_default,\n      response.sprites.back_default,\n    ],\n    types: response.types\n      .sort((a, b) => Math.sign(b.slot - a.slot))\n      .map(type => type.type.name),\n  };\n}\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAMAAADVRocKAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJUExURQAAAP///wAAAHPGg3EAAAADdFJOU///ANfKDUEAAAAJcEhZcwAADsMAAA7DAcdvqGQAAACoSURBVGhD7dJLCoRAEATRmb7/oedXIrOKyoYChYiNrYt8iD7WcAKYACaACWACmAAmgAlgApgAlgDPqm57tYEa/1XPOnWBWj6qp40S4DwFQh+ow7tIaAN1/TYB/CWATQPJ/g7w2Z8Esv0cCPdjIN1PgXg/BPL9DaCO3SJg4wVyoI7tBLBrfeSdBLCLAbf/Te8PjH+DnQQwAUwAE8AEMAFMABPABDABaK0XovlHYv9vwRMAAAAASUVORK5CYII=\"","import axios from \"axios\";\n\nimport { useEffect, useState } from \"react\";\nimport { useInfiniteQuery } from \"react-query\";\n\nimport useQ from \"../hooks/useCachedQuery\";\n\nimport {\n  PokemonResponse,\n  PokemonsResponse,\n  ResponseReference,\n} from \"./PokeAPI\";\n\nimport Pokemon, { getPokemon } from \"./Pokemon\";\n\nimport UnknownPokemonPNG from \"./unknown-pokemon.png\";\n\nexport { UnknownPokemonPNG };\n\nexport function getUnknownPokemon(pokemon: Pokemon, error: boolean) {\n  if (error) return UnknownPokemonPNG;\n  return pokemon.sprites[1] || pokemon.sprites[0] || UnknownPokemonPNG;\n}\n\nexport function getGenerationRomanNumeral(generationId: string) {\n  return generationId.slice(11).toUpperCase();\n}\n\nexport const GenerationHumanizedText: Record<string, string> = {\n  \"generation-i\": \"first generation\",\n  \"generation-ii\": \"second generation\",\n  \"generation-iii\": \"third generation\",\n  \"generation-iv\": \"fourth generation\",\n  \"generation-v\": \"fifth generation\",\n  \"generation-vi\": \"sixth generation\",\n  \"generation-vii\": \"seventh generation\",\n  \"generation-viii\": \"eighth generation\",\n};\n\nconst cache = {};\n\nexport function usePokemonQuery(url: string) {\n  const [result, setResult] = useState<Pokemon | null>(null);\n\n  const [response, error, loading] = useQ<PokemonResponse>(cache, url);\n\n  useEffect(() => {\n    if (response) {\n      setResult(getPokemon(response));\n    }\n  }, [response]);\n\n  return [result, error, loading] as const;\n}\n\nconst backend = \"https://pokeapi.co/api/v2/pokemon/\";\nconst stride = 50;\n\nfunction getPokemons(page: number) {\n  return `${backend}?limit=${stride}&offset=${stride * page}`;\n}\n\nexport function useInfinitePokemonQuery() {\n  const [pokemons, setPokemons] = useState<ResponseReference[]>([]);\n\n  const {\n    isFetchingNextPage,\n    hasNextPage,\n    fetchNextPage,\n    status,\n    error,\n    data,\n  } = useInfiniteQuery(\n    \"pokemons\",\n    async ({ pageParam = 0 }) => {\n      const url = getPokemons(pageParam);\n\n      const result = await axios.get<PokemonsResponse>(url);\n\n      return result.data.results;\n    },\n    {\n      getNextPageParam(last, all) {\n        return last.length ? all.length : false;\n      },\n    }\n  );\n\n  useEffect(() => {\n    if (!data) return;\n    setPokemons(data.pages.flat(1));\n  }, [data]);\n\n  return [\n    pokemons,\n    !hasNextPage,\n    fetchNextPage,\n    isFetchingNextPage,\n    error,\n    status,\n  ] as const;\n}\n\nexport function noop() {}\n","import { useEffect, useState } from \"react\";\n\nimport axios, { Canceler } from \"axios\";\n\nexport type QueryResult<T> = readonly [\n  result: T | null,\n  error: string,\n  loading: boolean\n];\n\nexport default function useQuery<T>(\n  cache: Record<string, T>,\n  query: string\n): QueryResult<T> {\n  const [result, setResult] = useState<T | null>(null);\n  const [error, setError] = useState<string>(\"\");\n  const [loading, setLoading] = useState(false);\n\n  useEffect(() => {\n    const cached = cache[query];\n\n    if (cached) {\n      setResult(cached);\n      setError(\"\");\n      setLoading(false);\n      return;\n    }\n\n    let canceler: Canceler;\n\n    const token = new axios.CancelToken(c => (canceler = c));\n\n    setLoading(true);\n\n    axios\n      .get<T>(query, { cancelToken: token })\n      .then(\n        response => {\n          const result = response.data;\n          cache[query] = result;\n          setResult(result);\n          setLoading(false);\n        },\n        error => {\n          if (axios.isCancel(error)) return;\n          setError(error);\n          setLoading(false);\n        }\n      );\n\n    return () => canceler();\n  }, [cache, query]);\n\n  return [result, error, loading];\n}\n","import { useCallback, useState } from \"react\";\nimport { UnknownPokemonPNG } from \"../models/utilities\";\n\nexport default function PokemonImage({\n  name,\n  sprites,\n}: {\n  name: string;\n  sprites: [string | null, string | null];\n}) {\n  const [flipped, setFlipped] = useState(false);\n\n  const front = sprites[0] || UnknownPokemonPNG;\n  const back = sprites[1] || UnknownPokemonPNG;\n\n  const toggleFlipped = useCallback(() => {\n    setFlipped(!flipped);\n  }, [flipped]);\n\n  return (\n    <figure\n      onClick={toggleFlipped}\n      className=\"pokemon-image\"\n      title=\"Click to flip\"\n    >\n      <img\n        src={flipped ? back : front}\n        alt={`${flipped ? \"Back\" : \"Front\"} view of ${name}.`}\n      />\n      <figcaption>\n        {flipped ? \"Back\" : \"Front\"} view of {name}.\n      </figcaption>\n    </figure>\n  );\n}\n","import { PropsWithChildren } from \"react\";\n\nimport { ResponseReference } from \"../models/PokeAPI\";\nimport { getPokemonName } from \"../models/Pokemon\";\nimport { usePokemonQuery } from \"../models/utilities\";\nimport PokemonImage from \"./PokemonImage\";\n\ntype PokemonUnselect = {\n  unselect(): void;\n};\n\ntype PokemonSelected = {\n  selected: ResponseReference;\n};\n\ntype PokemonNullableSelected = {\n  selected: ResponseReference | null;\n};\n\nexport type PokemonDetailsProps = PokemonNullableSelected &\n  PokemonUnselect;\n\nexport default function PokemonDetails({\n  selected,\n  unselect,\n}: PokemonDetailsProps) {\n  return (\n    <>\n      {selected ? (\n        <PokemonDetailsView selected={selected} unselect={unselect} />\n      ) : (\n        <main className=\"pokemon-details closed\">\n          Select a pokemon from the right panel.\n        </main>\n      )}\n    </>\n  );\n}\nexport type PokemonDetailsViewProps = PokemonSelected & PokemonUnselect;\n\nfunction PokemonDetailsView({\n  selected,\n  unselect,\n}: PokemonDetailsViewProps) {\n  const [pokemon, error, loading] = usePokemonQuery(selected.url);\n\n  const stateClassNames: string[] = [];\n\n  loading && stateClassNames.push(\"loading\");\n  error && stateClassNames.push(\"error\");\n\n  return (\n    <article\n      className={`pokemon-details open ${stateClassNames.join(\" \")}`}\n    >\n      {pokemon ? (\n        <>\n          <PokemonDetailsHeader unselect={unselect}>\n            {pokemon.name}\n            <code>#{pokemon.id}</code>\n          </PokemonDetailsHeader>\n          <PokemonImage name={pokemon.name} sprites={pokemon.sprites} />\n        </>\n      ) : loading ? (\n        <i className=\"gg-spinner\" />\n      ) : (\n        <>\n          <PokemonDetailsHeader unselect={unselect}>\n            Error loading data {getPokemonName(selected.name)}\n          </PokemonDetailsHeader>\n          <main>{error}</main>\n        </>\n      )}\n    </article>\n  );\n}\n\nfunction PokemonDetailsHeader({\n  unselect,\n  children,\n}: PropsWithChildren<PokemonUnselect>) {\n  return (\n    <header>\n      <button onClick={unselect}>\n        <i className=\"gg-chevron-left\"></i>\n      </button>\n      <h1>{children}</h1>\n    </header>\n  );\n}\n","import { useCallback, useEffect, useRef, useState } from \"react\";\n\nimport { useVirtual } from \"react-virtual\";\n\nimport { ResponseReference } from \"../models/PokeAPI\";\nimport Pokemon, { getPokemonName } from \"../models/Pokemon\";\n\nimport {\n  getUnknownPokemon as getMisteryPokemonSprite,\n  noop,\n  useInfinitePokemonQuery,\n  usePokemonQuery,\n} from \"../models/utilities\";\n\ninterface PokemonEntryProps {\n  pokemon: ResponseReference;\n}\n\nfunction PokemonMistryImage({ pokemon }: { pokemon: Pokemon | null }) {\n  const [loaded, setLoaded] = useState(false);\n  const [error, setError] = useState(false);\n\n  const onLoad = useCallback(() => {\n    setLoaded(true);\n  }, []);\n\n  const onError = useCallback(() => {\n    setLoaded(true);\n    setError(true);\n  }, []);\n\n  return (\n    <>\n      {pokemon ? (\n        <img\n          hidden={!loaded}\n          className=\"unknown-pokemon-image\"\n          src={getMisteryPokemonSprite(pokemon, error)}\n          onLoad={onLoad}\n          onError={onError}\n          alt=\"\"\n        />\n      ) : null}\n      {loaded ? null : (\n        <div className=\"unknown-pokemon-image\">\n          <div className=\"gg-spinner\" />\n        </div>\n      )}\n    </>\n  );\n}\n\nfunction PokemonEntry({ pokemon: reference }: PokemonEntryProps) {\n  const [pokemon] = usePokemonQuery(reference.url);\n\n  return (\n    <>\n      <PokemonMistryImage pokemon={pokemon} />\n      <div className=\"pokemon-name\">\n        {pokemon ? pokemon.name : getPokemonName(reference.name)}\n      </div>\n      <div className=\"pokemon-id\">\n        #{pokemon ? pokemon.id : getPokemonIdFromURL(reference)}\n      </div>\n    </>\n  );\n}\n\nfunction getPokemonIdFromURL(reference: ResponseReference) {\n  const url = reference.url;\n  return url.slice(url.lastIndexOf(\"/\", url.length - 2) + 1, -1);\n}\n\nexport interface PokemonNavigationProps {\n  selected: ResponseReference | null;\n  setSelected(selected: ResponseReference | null): void;\n}\n\nexport default function PokemonNavigation({\n  selected,\n  setSelected,\n}: PokemonNavigationProps) {\n  const [data, done, fetch, loading] = useInfinitePokemonQuery();\n\n  const parentRef = useRef<HTMLDivElement>(null!);\n\n  const { virtualItems, totalSize } = useVirtual({\n    parentRef: parentRef,\n    size: done ? data.length : data.length + 1,\n    estimateSize: useCallback(() => 100, []),\n  });\n\n  useEffect(() => {\n    const last = virtualItems[virtualItems.length - 1];\n\n    if (!last) return;\n\n    const canFetchNextPage = !done && !loading;\n\n    const isLastPokemonOnScreen = last.index >= data.length - 1;\n\n    if (canFetchNextPage && isLastPokemonOnScreen) {\n      fetch();\n    }\n  }, [data.length, virtualItems, loading, done, fetch]);\n\n  return (\n    <nav ref={parentRef} className=\"pokemon-navigation\">\n      <ul style={{ height: totalSize }}>\n        {virtualItems.map(row => {\n          const isOverflow = row.index > data.length - 1;\n          const isLoadingRow = isOverflow && !done;\n\n          const pokemon = data[row.index];\n\n          return (\n            <li\n              className={\n                isLoadingRow\n                  ? \"loading\"\n                  : selected &&\n                    (selected === pokemon ||\n                      selected.name === pokemon.name)\n                  ? \"active\"\n                  : \"\"\n              }\n              tabIndex={row.index + 1}\n              key={row.index}\n              ref={row.measureRef}\n              style={{ transform: `translateY(${row.start}px)` }}\n              onClick={isOverflow ? noop : () => setSelected(pokemon)}\n            >\n              {isLoadingRow ? (\n                <div className=\"unknown-pokemon-image\">\n                  <div className=\"gg-spinner\" />\n                </div>\n              ) : isOverflow ? null : (\n                <PokemonEntry pokemon={pokemon} />\n              )}\n            </li>\n          );\n        })}\n      </ul>\n    </nav>\n  );\n}\n","import { useCallback, useState } from \"react\";\n\nimport PokemonDetails from \"./components/PokemonDetails\";\nimport PokemonNavigation from \"./components/PokemonNavigation\";\n\nimport { ResponseReference } from \"./models/PokeAPI\";\n\nexport default function App() {\n  const [selected, setSelected] = useState<ResponseReference | null>(null);\n\n  const unselect = useCallback(() => setSelected(null), []);\n\n  return (\n    <>\n      <AppHeader />\n      <PokemonNavigation selected={selected} setSelected={setSelected} />\n      <PokemonDetails selected={selected} unselect={unselect} />\n      <AppFooter />\n    </>\n  );\n}\n\nfunction AppHeader() {\n  return (\n    <header>\n      <h1>Pokedex</h1>\n    </header>\n  );\n}\n\nfunction AppFooter() {\n  return (\n    <footer>\n      <p>All right rights reserved to their respective owners.</p>\n      <p>\n        {\"Website made using \"}\n        <a\n          target=\"_blank\"\n          rel=\"noreferrer\"\n          href=\"https://pokeapi.co/docs/v2\"\n        >\n          PokeAPI\n        </a>\n        {\" backend. Source available on \"}\n        <a\n          target=\"_blank\"\n          rel=\"noreferrer\"\n          href=\"https://github.com/blfunex/pokemons/\"\n        >\n          GitHub\n        </a>\n        .\n      </p>\n      <p>Pokemons are a &copy; intellectual property of Nintendo.</p>\n    </footer>\n  );\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\n\nimport { QueryClient, QueryClientProvider } from \"react-query\";\n\nimport \"./root.css\";\n\nimport App from \"./App\";\n\nconst client = new QueryClient();\n\nReactDOM.render(\n  <React.StrictMode>\n    <QueryClientProvider client={client}>\n      <App />\n    </QueryClientProvider>\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\n/* eslint-disable no-restricted-globals */\n// Just for my website, it does not reroute to https.\nif (\n  location.protocol !== \"https:\" &&\n  !location.host.startsWith(\"localhost\")\n) {\n  location.href = location.href.replace(\"http://\", \"https://\");\n}\n"],"sourceRoot":""}