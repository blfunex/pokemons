{"version":3,"sources":["components/image.tsx","components/details.tsx","hooks/useModalDialog.ts","hooks/useSpeechSynthesis.ts","PokedexInfo.tsx","App.tsx","index.tsx"],"names":["PokemonImage","name","back","front","useState","showBack","setShowBack","className","onClick","src","alt","PokemonDetails","pokemon","flavor","sprites","types","isOpen","setIsOpen","overflow","setOriginalOverflow","ref","useRef","open","useCallback","window","getComputedStyle","document","body","style","close","onOpenDialog","dialog","current","removeAttribute","showModal","onCloseDialog","onDialogBackdropClicked","event","target","callback","node","removeEventListener","addEventListener","useEffect","useModalDialog","isOpened","pitch","rate","synth","speechSynthesis","voices","setVoices","names","setNames","selected","setSelectedVoice","getVoices","filter","voice","lang","sort","a","b","aname","toUpperCase","bname","map","console","log","length","cancel","speak","text","utterance","SpeechSynthesisUtterance","select","findIndex","useSpeechSynthesis","type","items","suffix","prefix","slice","join","subjunction","index","colors","fire","grass","electric","water","ground","rock","fairy","poison","bug","dragon","psychic","flying","fighting","normal","supportedTypes","Object","keys","PokedexInfo","id","main_type","find","indexOf","hasFlavorText","background","undefined","color","reducer","state","action","pokemons","concat","next","initial","fetchJSON","input","init","fetch","then","response","status","statusText","json","map_async","transform","Promise","all","list","x","rxWierdCharacter","RegExp","fetchFlavorText","data","flavor_text_entries","entry","language","flavor_text","replace","lowercase","toLowerCase","_","fetchPokemon","url","front_default","back_default","item","App","useReducer","dispatch","done","setIsDone","fetchData","results","ReactDOM","render","StrictMode","getElementById","location","protocol","host","startsWith","href"],"mappings":"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","file":"static/js/main.d4ec344e.chunk.js","sourcesContent":["import { useState } from \"react\";\n\nexport default function PokemonImage({\n  name,\n  back,\n  front,\n}: {\n  name: string;\n  back: string;\n  front: string;\n}) {\n  const [showBack, setShowBack] = useState(false);\n\n  return (\n    <figure\n      className={\"pokedex-image \" + (showBack ? \"show-back\" : \"\")}\n      onClick={() => setShowBack(!showBack)}\n    >\n      {front && (\n        <>\n          <img\n            className=\"is-front\"\n            src={front}\n            alt={`A front view depiction of ${name}.`}\n          />\n          {back ? (\n            <img\n              className=\"is-back\"\n              src={back}\n              alt={`A back view depiction of ${name}.`}\n            />\n          ) : (\n            <img className=\"is-back is-alt\" src={front} alt=\"\" />\n          )}\n        </>\n      )}\n    </figure>\n  );\n}\n","import PokemonImage from \"./image\";\n\nimport useModalDialog from \"../hooks/useModalDialog\";\n\nimport type { Pokemon } from \"../PokedexInfo\";\nimport useSpeechSynthesis from \"../hooks/useSpeechSynthesis\";\nimport { useEffect } from \"react\";\n\nfunction subjunction(items: string[], suffix = \"\", prefix = \"\") {\n  switch (items.length) {\n    case 0:\n      return \"\";\n    case 1:\n      return `${prefix} ${items[0]} and ${items[1]} ${suffix}`;\n    default:\n      return `${prefix} ${items.slice(0, -1).join(\", \")} and ${\n        items[items.length - 1]\n      } ${suffix}`;\n  }\n}\n\nexport default function PokemonDetails({\n  pokemon: { flavor, name, sprites, types },\n}: {\n  pokemon: Pokemon;\n}) {\n  const [ref, close, open, isOpened] = useModalDialog();\n\n  const [speak, cancel] = useSpeechSynthesis();\n\n  useEffect(() => {\n    if (!isOpened) cancel();\n  }, [cancel, isOpened]);\n\n  return (\n    <>\n      <div className=\"pokedex-details\">\n        <button\n          type=\"button\"\n          className=\"nes-button\"\n          onClick={() => {\n            open();\n            speak(\n              `This is ${name}, ${subjunction(\n                types,\n                \"pokemon\",\n                \"it is a\"\n              )}.\\n${flavor.join(\"\\n\")}`\n            );\n          }}\n        >\n          More details\n        </button>\n        <dialog className=\"nes-dialog pokedex-dialog\" ref={ref}>\n          <header>\n            <h3>{name}'s details</h3>\n            <button type=\"button\" onClick={close}>\n              <i className=\"nes-icon is-small close\"></i>\n            </button>\n          </header>\n          <main>\n            <PokemonImage\n              name={name}\n              front={sprites[0]}\n              back={sprites[1]}\n            />\n            <section>\n              {flavor.map((text, index) => (\n                <p key={index}>{text}</p>\n              ))}\n            </section>\n          </main>\n        </dialog>\n      </div>\n    </>\n  );\n}\n","import { useCallback, useEffect, useRef, useState } from \"react\";\n\nexport default function useModalDialog() {\n  const [isOpen, setIsOpen] = useState(false);\n  const [overflow, setOriginalOverflow] = useState(\"\");\n\n  const ref = useRef<HTMLDialogElement>(null!);\n\n  const open = useCallback(function open() {\n    setOriginalOverflow(window.getComputedStyle(document.body).overflow);\n    document.body.style.overflow = \"hidden\";\n    setIsOpen(true);\n  }, []);\n\n  const close = useCallback(\n    function close() {\n      document.body.style.overflow = overflow;\n      setIsOpen(false);\n    },\n    [overflow]\n  );\n\n  const onOpenDialog = useCallback(function onOpenDialog() {\n    const dialog = ref.current;\n    if (dialog) {\n      dialog.removeAttribute(\"open\");\n      dialog.showModal();\n    }\n  }, []);\n\n  const onCloseDialog = useCallback(function onCloseDialog() {\n    ref.current?.close();\n  }, []);\n\n  const onDialogBackdropClicked = useCallback(\n    function onDialogBackdropClicked(event: Event) {\n      if (event.target === ref.current) close();\n    },\n    [close]\n  );\n\n  const callback = useCallback(\n    function refDialogCallback(node: HTMLDialogElement) {\n      const current = ref.current;\n\n      ref.current = node;\n\n      if (current) {\n        current.removeEventListener(\"click\", onDialogBackdropClicked);\n        current.removeEventListener(\"close\", onCloseDialog);\n      }\n\n      if (node) {\n        node.addEventListener(\"click\", onDialogBackdropClicked);\n        node.addEventListener(\"close\", onCloseDialog);\n      }\n    },\n    [onDialogBackdropClicked, onCloseDialog]\n  );\n\n  useEffect(() => {\n    if (isOpen) {\n      onOpenDialog();\n    } else {\n      onCloseDialog();\n    }\n  }, [isOpen, onCloseDialog, onOpenDialog]);\n\n  return [callback, close, open, isOpen] as const;\n}\n","import { useCallback, useEffect, useState } from \"react\";\n\n// Inspired by https://mdn.github.io/web-speech-api/speak-easy-synthesis/\n\nexport default function useSpeechSynthesis(\n  pitch: number = 1,\n  rate: number = 1.5\n) {\n  const synth = window.speechSynthesis;\n\n  const [voices, setVoices] = useState<SpeechSynthesisVoice[]>([]);\n\n  const [names, setNames] = useState<string[]>([]);\n\n  const [selected, setSelectedVoice] = useState(-1);\n\n  useEffect(() => {\n    if (!synth) return;\n\n    const voices = synth\n      .getVoices()\n      .filter(voice => voice.lang === \"en\")\n      .sort(function (a, b) {\n        const aname = a.name.toUpperCase(),\n          bname = b.name.toUpperCase();\n        if (aname < bname) return -1;\n        else if (aname === bname) return 0;\n        else return +1;\n      });\n\n    setVoices(voices);\n\n    setNames(voices.map(voice => voice.name));\n\n    console.log(voices);\n\n    if (voices.length > 0) setSelectedVoice(0);\n  }, [synth]);\n\n  const cancel = useCallback(\n    function cancel() {\n      synth.cancel();\n    },\n    [synth]\n  );\n\n  const speak = useCallback(\n    function speak(text: string) {\n      if (!synth) return;\n\n      synth.cancel();\n\n      const utterance = new SpeechSynthesisUtterance(text);\n\n      if (selected < 0) utterance.voice = voices[selected];\n\n      utterance.pitch = pitch;\n      utterance.rate = rate;\n\n      synth.speak(utterance);\n    },\n    [pitch, rate, selected, synth, voices]\n  );\n\n  const select = useCallback(\n    function select(name: string) {\n      setSelectedVoice(voices.findIndex(voice => voice.name === name));\n    },\n    [voices]\n  );\n\n  return [speak, cancel, select, names] as const;\n}\n","import PokemonDetails from \"./components/details\";\nimport PokemonImage from \"./components/image\";\n\nexport type Pokemon = {\n  id: string;\n  name: string;\n  sprites: [string, string];\n  flavor: string[];\n  types: string[];\n};\n\ninterface PokedexInfoProps {\n  pokemon: Pokemon;\n}\n\nconst colors: Record<string, string> = {\n  fire: \"#FFA341\",\n  grass: \"#98d7a5\",\n  electric: \"#F2E04C\",\n  water: \"#AABEFF\",\n  ground: \"#D79624\",\n  rock: \"#d5d5d4\",\n  fairy: \"#FFC8CF\",\n  poison: \"#BC8FED\",\n  bug: \"#f8d5a3\",\n  dragon: \"#97b3e6\",\n  psychic: \"#eaeda1\",\n  flying: \"#FFECC0\",\n  fighting: \"#E6E0D4\",\n  normal: \"#D5D5D5\",\n};\n\nconst supportedTypes = Object.keys(colors);\n\nexport default function PokedexInfo({ pokemon }: PokedexInfoProps) {\n  const { id, name, types, flavor, sprites } = pokemon;\n\n  const main_type = supportedTypes.find(type => types.indexOf(type) >= 0);\n\n  const hasFlavorText = flavor.length > 0;\n\n  return (\n    <>\n      <article\n        className=\"pokedex-info\"\n        style={{\n          background: main_type ? colors[main_type] : undefined,\n        }}\n      >\n        <PokemonImage name={name} front={sprites[0]} back={sprites[1]} />\n        <section>\n          <header>\n            <h3>{name}</h3>\n            <h5>#{id}</h5>\n          </header>\n          <section>\n            {types.map((type, index) => (\n              <span key={index} className=\"nes-badge\">\n                <span\n                  className=\"is-dark\"\n                  style={{\n                    color: colors[type],\n                  }}\n                >\n                  {type}\n                </span>\n              </span>\n            ))}\n            {hasFlavorText ? (\n              <>\n                <p>{flavor[0]}</p>\n                <PokemonDetails pokemon={pokemon} />\n              </>\n            ) : (\n              <p>No details were found about this pokemon</p>\n            )}\n          </section>\n        </section>\n      </article>\n    </>\n  );\n}\n","import { useEffect, useReducer, useState } from \"react\";\n\nimport PokedexInfo, { Pokemon } from \"./PokedexInfo\";\n\ntype Action = {\n  type: \"ADD_POKEMONS\";\n  pokemons: Pokemon[];\n  next: string;\n};\n\ntype State = {\n  next: string;\n  pokemons: Pokemon[];\n};\n\nfunction reducer(state: State, action: Action) {\n  switch (action.type) {\n    case \"ADD_POKEMONS\":\n      return {\n        ...state,\n        pokemons: state.pokemons.concat(action.pokemons),\n        next: action.next,\n      };\n    default:\n      return state;\n  }\n}\n\nconst initial = {\n  pokemons: [],\n  next: \"https://pokeapi.co/api/v2/pokemon/?limit=30\",\n};\n\nfunction fetchJSON(input: RequestInfo, init?: RequestInit) {\n  return fetch(input, init).then(response => {\n    if (response.status !== 200) throw response.statusText;\n    return response.json();\n  });\n}\n\nfunction map_async<T, U>(\n  input: T[],\n  transform: (input: T) => Promise<U | null>\n) {\n  return Promise.all(input.map(transform)).then(list =>\n    list.filter(x => x)\n  );\n}\n\n// eslint-disable-next-line no-control-regex\nconst rxWierdCharacter = new RegExp(\"\f|\\\\n\", \"g\");\n\nasync function fetchFlavorText(id: string): Promise<string[]> {\n  try {\n    const data = await fetchJSON(\n      `https://pokeapi.co/api/v2/pokemon-species/${id}/`\n    );\n\n    const flavor: string[] = data.flavor_text_entries\n      .filter((entry: any) => entry.language.name === \"en\")\n      .map((entry: any) =>\n        entry.flavor_text.replace(rxWierdCharacter, \" \")\n      );\n\n    const lowercase = flavor.map(text => text.toLowerCase());\n\n    return flavor.filter((_, index) => {\n      return lowercase.indexOf(lowercase[index], index + 1) < 0;\n    });\n  } catch {\n    return [];\n  }\n}\n\nasync function fetchPokemon({\n  url,\n  name,\n}: {\n  url: string;\n  name: string;\n}): Promise<Pokemon | null> {\n  try {\n    const data = await fetchJSON(url);\n    return {\n      id: data.id,\n      name: name[0].toUpperCase() + name.slice(1),\n      sprites: [data.sprites.front_default, data.sprites.back_default],\n      types: data.types.map((item: any) => item.type.name),\n      flavor: await fetchFlavorText(data.id),\n    };\n  } catch {\n    return null;\n  }\n}\n\nfunction App() {\n  const [state, dispatch] = useReducer(reducer, initial);\n  const [done, setIsDone] = useState(false);\n\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  useEffect(() => void fetchData(), []);\n\n  async function fetchData() {\n    if (!state.next) return setIsDone(true);\n    const data = await fetchJSON(state.next);\n    dispatch({\n      type: \"ADD_POKEMONS\",\n      pokemons: (await map_async(data.results, fetchPokemon)) as Pokemon[],\n      next: data.next,\n    });\n  }\n\n  return (\n    <>\n      <div className=\"pokedex\">\n        {state.pokemons.map((pokemon, index) => (\n          <PokedexInfo key={index} pokemon={pokemon} />\n        ))}\n      </div>\n      {done || <button onClick={fetchData}>Load more ...</button>}\n    </>\n  );\n}\n\nexport default App;\n","/* eslint-disable no-restricted-globals */\n\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\n\nimport \"./index.css\";\n\nimport App from \"./App\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\nif (\n  location.protocol !== \"https:\" &&\n  !location.host.startsWith(\"localhost\")\n) {\n  location.href = location.href.replace(\"http://\", \"https://\");\n}\n"],"sourceRoot":""}